<!DOCTYPE html>
<html lang="en">
<head>
  <title>Journey</title>
  <meta charset="utf-8">
  <!-- Katharina Brandtner -->
  <meta name="author" content="Katharina Brandtner">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    
    <link rel="icon" type="image/x-icon" href="logo_kreis.png">

    <script src="https://kit.fontawesome.com/1b046ec410.js" crossorigin="anonymous"></script>

  <link href="styles.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar fixed-top navbar-expand-sm justify-content-center">
        <div class="container">
          <a class="navbar-brand" href="index.html"><img src="images/logo.png" alt="Logo" width="50%" class="img-fluid"></a>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="all_journeys.html">All Journeys</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Gallery</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Guides</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Profile</a>
            </li>
          </ul>
        </div>
      </nav>





<div class="container mt-5">
    <br>
    <br>
    <br>
    <br>
    <h1 class="light">Edit</h1><h1 class="bold">Journey</h1>
<form id="editForm">
    <div class="row">
      <div class="col-sm-5">
        
        <div class="input-group mb-3">
          <span class="input-group-text">Country<span class="orange abstandrechts">*</span>
          <input type="text" class="form-control" id="country" name="country" value="" required>
        </div>
        
        <div class="input-group mb-3">
            <span class="input-group-text">Start Date<span class="orange abstandrechts">*</span>
            <input type="date" class="form-control" id="startdate" name="startdate" value="" required>
        </div>
        <div class="input-group mb-3">
            <span class="input-group-text">End Date<span class="orange abstandrechts">*</span>
            <input type="date" class="form-control" id="enddate" name="enddate" value="" required>
        </div>
        


        <div class="input-group mb-3">
            <span class="input-group-text">Guide<span class="abstandrechts"></span>
            <select class="form-select" id="guide" name="guide">
              <option value="no guide yet">no guide yet</option>
              <option value="Luca Esposito (HUN)">Luca Esposito (HUN)</option>
              <option value="Elias Constantinou (IT)"> Elias Constantinou (IT)</option>
              <option value="Massimo Rossi (ESP)">Massimo Rossi (ESP)</option>
              <option value="Mark Haller (GER)">Mark Haller (GER)</option>
            </select>
        </div>

        <div class="input-group mb-3">
            <span class="input-group-text">Comments:<span class="abstandrechts"></span>
            <textarea class="form-control" rows="1" id="comment" name="comment" textcontent="" value=""></textarea>
        </div>  
        <label for="comment"></label>
    
      </div>
      <div class="col-sm-7"><img src="images/formsimg.png" class="img-fluid" alt="Sydney"></div>
    </div>
    <h1 class="light">Citys</h1>
        <div class="row">
            <div class="col-sm-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">City<span class="abstandrechts"></span>
                    <input type="text" class="form-control" id="cityone" name="cityone">
                </div>
                <div class="input-group mb-3">
                    <span class="input-group-text">lenth of stay (in days)<span class="abstandrechts"></span>
                    <input type="number" class="form-control" id="numbercityone" name="numbercityone">
                </div>
            </div>
            <div class="col-sm-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">City<span class="abstandrechts"></span>
                    <input type="text" class="form-control" id="citytwo" name="citytwo">
                </div>
                <div class="input-group mb-3">
                    <span class="input-group-text">lenth of stay (in days)<span class="abstandrechts"></span>
                    <input type="number" class="form-control" id="numbercitytwo" name="numbercitytwo">
                </div>
            </div>
            <div class="col-sm-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">City<span class="abstandrechts"></span>
                    <input type="text" class="form-control" id="citythree" name="citythree">
                </div>
                <div class="input-group mb-3">
                    <span class="input-group-text">lenth of stay (in days)<span class="abstandrechts"></span>
                    <input type="number" class="form-control" id="numbercitythree" name="numbercitythree">
                </div>
            </div>

            
        </div>
        <button type="submit" class="btn btn-lg btn-dark">Save changes <i class="fa-solid fa-arrow-right-long"></i></button>
        <a href="all_journeys.html"><button type="button" class="btn btn-lg btn-white">dont save changes</button></a>
</form>
</div>

<div class="footer">
<div class="container mt-5 p-4">
    <div class="row">
        <div class="col-sm-4"><img class="img-fluid" src="images/logo light.png" width="30%" alt="Logo"></div>
        <div class="col-sm-2">
            <p>
                <span class="bold">Information</span><br>
                <a href="index.html">Home</a><br>
                <a href="all_journeys.html">All Journeys</a><br>
                <a href="#">Gallery</a><br>
                <a href="#">Guides</a><br>
                <a href="#">Profil</a><br>
            </p>
        </div>
        <div class="col-sm-2">
            <p>
                <span class="bold">Contacts</span><br>
                Lothstraße 34<br>
                80335 München<br><br>
                +49 151 123 456 78<br>
                brandtne@hm.edu
            </p>
        </div>
        <div class="col-sm-4">
            <p><i class="fa-brands fa-facebook-f"></i> <i class="fa-brands fa-instagram"></i> <i class="fa-brands fa-linkedin"></i> <i class="fa-brands fa-pinterest-p"></i></p>
        </div>
    </div>
    <hr>
    <p class="center">&copy; 2024 by Katharina Brandtner</p>
</div>
</div>


<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const params = new URLSearchParams(window.location.search);
  const tripId = params.get('id');

  axios.get(`http://localhost:8000/api/trips/${tripId}`)
    .then((response) => {
      const trip = response.data;

      document.getElementById('country').value = trip.country;
      document.getElementById('startdate').value = trip.startDate;
      document.getElementById('enddate').value = trip.endDate;
      document.getElementById('guide').value = trip.guide;
      document.getElementById('comment').value = trip.comment;
      //city fehlt noch
    })
    .catch((error) => {
      console.error('Error fetching trip:', error);
      alert('Failed to load trip data.');
    });
});

// Änderungen speichern
document.getElementById('editForm').addEventListener('submit', (e) => {
  e.preventDefault();

  const params = new URLSearchParams(window.location.search);
  const tripId = params.get('id');

  const updatedTrip = {
    country: document.getElementById('country').value,
    startDate: document.getElementById('startdate').value,
    endDate: document.getElementById('enddate').value,
    guide: document.getElementById('guide').value,
    comment: document.getElementById('comment').value,
  };

  axios.put(`http://localhost:8000/api/trips/${tripId}`, updatedTrip)
    .then((response) => {
      alert('Trip updated successfully!');
      window.location.href = 'http://localhost:8000/all_journeys.html';
    })
    .catch((error) => {
      console.error('Error updating trip:', error);
      
      if (error.response) {
        console.error('Response data:', error.response.data);
        console.error('Response status:', error.response.status);
        console.error('Response headers:', error.response.headers);
      } else if (error.request) {
        console.error('Request data:', error.request);
      } else {
        console.error('Error message:', error.message);
      }
      alert('Failed to update trip. Please check the console for more details.');
    });
});
</script>
</body>
</html>